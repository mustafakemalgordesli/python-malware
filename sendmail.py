from email.message import EmailMessage
import os
import ssl
import smtplib

from os import environ as env
from dotenv import load_dotenv

load_dotenv()

mail_address = env["MAIL_ADDRESS"]
mail_password = env["MAIL_PASSWORD"]

# print(mail_address, mail_password)


em = EmailMessage()
em["From"] = mail_address
em['To'] = mail_address

context = ssl.create_default_context()


def sendmail(subject, message):
    em["Subject"] = subject
    em.set_content(str(message))
    with smtplib.SMTP_SSL('smtp.gmail.com', 465, context=context) as smtp:
        smtp.login(mail_address, mail_password)
        smtp.sendmail(mail_address, mail_address, em.as_string())

# sendmail("Test","bu bir test mailidir")